---
- name: Install httpd packages
  yum: name={{ item }} state=latest
  with_items:
    - httpd
    - httpd-tools
    - mod_ssl

- name: Create {{ httpd_conf_dir }}/vhosts directory
  file: path={{ httpd_conf_dir }}/vhosts 
	state=directory 
	owner=root 
	group=root 
	mode=0755

- name: Copy over httpd.conf template
  template: src=httpd.conf.j2 
	dest={{ httpd_conf_dir }}/vhosts/ 
	owner=root 
	group=root 
	mode=0644

- name: Copy over virtual host template
  template: src=vhost.conf.j2 
	dest={{ httpd_conf_dir }}/vhosts/{{ ansible_fqdn }}.conf
	owner=root
	group=root
	mode=0644 

- name: Start httpd service
  service: name=httpd state=started enabled=true

